## 简介
- 技术栈无关：主框架不限制接入应用的技术展，子应用具备完全自主权
- 独立开发、独立部署：子应用仓库独立，前后端可独立开发，部署完成后主框架自动完成更新
- 独立运行：每个子应用状态隔离，运行时状态不共享
- 主框架的定位：导航路由 + 资源加载框架
- 由于子应用都是懒加载的，所以初次进去子应用的菜单可能会出现空白报错或者404，解决方案是定义入口路由，即`/app_a/*`，然后子应用要接管 url change 事件
- 在子应用切出时，要销毁该子应用
- 框架
  - Single-spa

## 组合方式 
- 构建时：子应用通过 npm package 方式引入主应用，与主应用一起打包发布
  - 优点：可以做打包优化，如依赖共享等  
  - 缺点：产品工具链耦合，依赖主应用
- 运行时：子应用自己构建打包，主应用运行时动态加载子应用资源
  - 优点：完全解藕，可以有独立的技术栈  
  - 缺点：多出一些运行时的复杂度和开销  

## 入口
### JS 入口
```html
<script src='//dist/index.min.js'></script>
<body>
  <main id="root"></main>
</body>
```
```javascript
ReactDOM.render(<App />, document.getElementById('id'))
```
- 1. 主应用需在子应用加载之前构建好响应的容器，然后子应用加载时会因为找不到 container 而报错
- 2. 优点：主和子应用使用同一个 bundler，方便做构建时优化
- 3. 缺点：子应用的发布需要主应用重新打包
- 4. 缺点：主应用需要为每个子应用预留一个容器节点，id需要和子应用的保持一致
- 5. 缺点：子应用的各类资源打包成一个 bundle，加载效率差

### HTML 入口
主应用注册子应用的方式：
```javascript
framework.registerApp(
  'app_1',
  {
    html: '',
    scripts: ['//1.app.com/dist/index.min.js'],
    css: ['//1.app.com/dist/index.min.css'],
  }
)
```

- 优点
  - 子应用完全独立
  - 子应用具备独立应用开发时一致的开发体验
- 缺点
  - 多一次请求，子应用资源解析消耗转移到运行时
  - 不处于同一个构建环境，无法利用 bundler 的一些构建起的优化能力，比如：公共依赖抽离

## 模块导入
- 需要子应用暴露一些钩子函数，接口之类的，从而能对接入应用有一个完整的生命周期
- 可以约定好全局变量控制

## 应用隔离
- 样式隔离：只需要子应用切出/卸载后，同时卸载其样式表。在 HTML 入口的模式下，可以直接移除其 HTML 结构
- JS隔离：在子应用挂载之前，给全局状态打个快照，在销毁/卸载时，恢复其全局状态。模拟沙箱环境